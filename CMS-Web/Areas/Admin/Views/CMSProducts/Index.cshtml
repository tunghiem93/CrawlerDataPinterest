@model CMS_DTO.CMSProduct.CMS_ProductsModels
@using CMS_Shared
@{
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
@{
    ViewBag.Title = "Sản phẩm - Danh sách";
}
<style>
    body {
        overflow-x: hidden;
    }

    .info {
        /*margin-left:20px;*/
    }

    .img-responsive {
        height: 236px;
    }
</style>

<div role="main">
    <div class="se-pre-con" style="display: none;"></div>
    <div class="_gridview">
        <div class="page-title">
            <!-- BEGIN PAGE BAR -->
            @Html.Partial("_breadcrumb", new Dictionary<string, string> { { "A", "Trang chủ" }, { "B", "Sản phẩm - Danh sách" } })
            <!-- END PAGE BAR -->
        </div>
        <div class="page-main">
            @using (Html.BeginForm("Search", "CMSProducts", FormMethod.Get, new { @class = "form-horizontal search-form", @id = "form-search" }))
            {
                <fieldset>
                    <legend>Nhóm mục từ khóa quét</legend>
                </fieldset>
                <div class="form-group">
                    <div class="col-md-3 col-sm-8 col-xs-12">
                        <div id="reportrange" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 90%">
                            <i class="fa fa-calendar"></i>&nbsp;
                            <span></span> <i class="fa fa-caret-down"></i>
                        </div>
                    </div>
                    @*<label for="FromDate" class="col-md-1 col-sm-3 col-xs-12 control-label">Thời gian</label>
        <div class="col-md-2 col-sm-2 col-xs-12 " style="width:13% !important">
            <div class="input-prepend input-group" style="width:100%">
                @Html.DropDownListFor(model => model.TypeTime,
                    new SelectList(Model.ListTime, "Value", "Text", Model.TypeTime), "",
                    new
                    {
                        @class = "form-control select2_multiple",
                        @id = "storeDdlView",
                        @style = "width:100%;",
                        @onChange = "ChangeDatetime(this);"
                    })
                @Html.ValidationMessageFor(model => model.TypeTime, null, new { @class = "label" })
            </div>
        </div>

        <div class="col-md-6 col-sm-6 col-xs-12 clsDate" style="width:26% !important">
            <div class="col-md-6 col-sm-6 col-xs-12">
                @Html.TextBoxFor(model => model.FromDate, new { @class = "form-control datepicker1 has-feedback-left", @placeholder = "Từ ngày", @autocomplete = "off" })
                @Html.ValidationMessageFor(model => model.FromDate, null, new { @class = "label label-danger" })
            </div>
            <div class="col-md-6 col-sm-6 col-xs-12">
                @Html.TextBoxFor(model => model.ToDate, new { @class = "form-control datepicker1 has-feedback-left", @placeholder = "Từ ngày", @autocomplete = "off" })
                @Html.ValidationMessageFor(model => model.ToDate, null, new { @class = "label label-danger" })
            </div>
        </div>*@

                    @*<label for="CustomeFromDate" class="col-md-1 col-sm-3 col-xs-12 control-label clsDate">Đến</label>
        <div class="col-md-2 col-sm-3 col-xs-12 clsDate" style="width:13% !important">
            @Html.TextBoxFor(model => model.ToDate, new { @class = "form-control datepicker1 has-feedback-left", @placeholder = "Từ ngày", @autocomplete = "off" })
            @Html.ValidationMessageFor(model => model.ToDate, null, new { @class = "label label-danger" })
        </div>*@
                    <div class="col-md-2 col-sm-2 col-xs-12 " style="width:13% !important">
                        <div class="input-prepend input-group" style="width:100%">
                            @Html.DropDownListFor(model => model.TypeQuantity,
                                new SelectList(Model.ListQuantity, "Value", "Text", Model.TypeQuantity), "",
                                new
                                {
                                    @class = "form-control select2_multiple",
                                    @id = "storeDdlViewQuantity",
                                    @style = "width:100%;"
                                })
                            @Html.ValidationMessageFor(model => model.TypeQuantity, null, new { @class = "label" })
                        </div>
                        @Html.ValidationMessageFor(model => model.Board, null, new { @class = "label" })
                    </div>
                    <div class="form-group">
                        <div class="col-md-1 col-sm-1 col-xs-12" style="width:4% !important">
                            <button class="btn btn-primary" id="form-search"><i class="fa fa-search"></i>&nbsp;Load Data</button>
                        </div>
                    </div>
                </div>
            }
            @*<div class="gridview" style="height:100%;"></div>*@
        </div>
    </div>
    <div class="detail-view" style="height:100%;display:inline-block">
        <fieldset>
            <legend>Danh sách kết quả tìm kiếm</legend>
        </fieldset>
        @Html.Partial("_ListItem", Model.Crawler)
        <!-- detail partial view -->
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        var start = moment().startOf('day');
        var end = moment().endOf('day');

        function cb(start, end) {
            $('#reportrange span').html(start.format('DD/MM/YYYY') + ' - ' + end.format('DD/MM/YYYY'));
        }

        $('#reportrange').daterangepicker({
            locale: {
                format: 'DD/MM/YYYY'
            },
            startDate: start,
            endDate: end,
            ranges: {
                'Today': [moment(), moment()],
                'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                'This Month': [moment().startOf('month'), moment().endOf('month')],
                'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
            }
        }, cb).on('show.daterangepicker', function (event, data) {
            var $container = data.container;
            $container.children('.calendar.right').after($container.children('.calendar.left'));
        });

        cb(start, end);
    })

    $("#form-search").on("click").submit(function (e) {
        $.ajax({
            beforeSend: function () {
                $('.se-pre-con').show();
            },
            url: $(this).attr('action'),
            type: "post",
            dataType: 'html',
            data: new FormData(this),
            processData: false,
            contentType: false,
            success: function (data) {
                $('.detail-view').html(data);
            },
            complete: function () {
                $('.se-pre-con').hide();
            },
            error: function (jqXHR, textStatus, errorThrown) {
              //  $(".detail-view").html(jqXHR.responseText);
            }
        });
        e.preventDefault();
    });
</script>